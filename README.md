# 新型冠状肺炎自监督分割任务

## 数据集
1. 20cases: https://zenodo.org/record/3757476#collapseOne 包含20个cases，有病灶、左肺、右肺的分割label（全部20个病例都用）
1. 国家生物信息中心: http://ncov-ai.big.ac.cn/download 同样是CT图像，但没有分割label（只用五个病例作为自监督的数据）

## 大概的任务流程
先用Unet去噪做自监督任务，再用Unet学到的特征做病灶分割任务。  
1. 数据处理： nii数据的可视化及格式转换、标准化（CT的窗宽窗位的分布）、分训练验证测试集（要按照病例分，同一个病例的数据不能出现在不同的数据集）
2. 自监督任务： 加噪声有两种（只加在肺部、整张图像都加）
3. 分割任务： 用上王欢的注意力模块、Diceloss

### 窗宽窗位
CT能识别人体内2000个不同灰阶的密度差别。而人的眼睛却只能分辨16 个灰阶度。因此，人眼在CT图像上能分辨的CT值应为125 Hu ( 2000 / 16 ）。换句话说，人体内不同组织CT 值只有相差125Hu 以上，才能为人眼所识别。人体软组织CT值多变化在20 - 50 Hu之间，人眼就无法识别。为此，必须进行分段观察，才能使CT 的优点反映出来。观察的CT 值范围，人们称之为窗宽；观察的中心CT值即为窗位或窗中心。  
肺部的窗宽窗位一般是1500和-600。

### 数据集
+ 300cases中有10个没有病灶，需要剔除用290个cases
+ nnUNet中需要数据和标签的像素间距保持一致，所以先对nii格式的数据处理使其像素间距保持一致
+ nii格式的数据调整窗宽床位和resize后分cases保存为npy格式
+ 290例case_data分为预训练集(0,220),训练集(x,220),验证集(220,240),测试集(240,290)


### 实验结果
+ 5cases
    + 未经过预训练, dice=0.5807
    + pretrain, dice=0.6501
+ 10cases
    + 未经过预训练, dice=0.7135
    + 经过预训练, dice=0.7614
+ 15cases
    + 未经过预训练, dice=0.7576
    + 经过预训练, dice=0.7881
+ 20cases
    + 未经过预训练, dice=0.7810
    + 经过预训练，dice:0.8075
+ 25cases
    + 未经过预训练, dice=0.7974
    + 经过预训练, dice=0.8124
+ 30cases
    + 未经过预训练, dice=0.7985
    + 经过预训练, dice=0.8203
+ 40cases
    + 未经过预训练, dice=0.8111
    + 经过预训练, dice=0.8226



对比
数据集病例个数
噪声种类、强度
可视化

去噪效果可视化
分割结果可视化
可解释性分析



